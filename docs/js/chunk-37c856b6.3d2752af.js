(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-37c856b6"],{"3c33":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"image-list-container"},[a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("el-radio-group",{attrs:{size:"mini"},on:{change:e.onLabelChange},model:{value:e.isCollect,callback:function(t){e.isCollect=t},expression:"isCollect"}},[a("el-radio-button",{attrs:{label:!1}},[e._v("全部")]),a("el-radio-button",{attrs:{label:!0}},[e._v("收藏")])],1),e.isShowAdd?a("el-button",{attrs:{type:"success",round:"",size:"mini"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("上传素材")]):e._e()],1),a("el-row",{staticClass:"image-list-wrapper",attrs:{gutter:20}},e._l(e.imageList,(function(t,i){return a("el-col",{key:i,staticClass:"image-container",attrs:{lg:4,md:6,sm:8,xs:12}},[a("div",{staticClass:"image-wrapper"},[a("el-image",{staticClass:"image",staticStyle:{height:"150px",width:"100%"},attrs:{src:t.url,"preview-src-list":e.isShowOperation?[t.url]:null,fit:"fill",lazy:""},on:{click:function(t){!e.isShowOperation&&e.onImageCheck(i)}}}),e.isShowChecked&&i===e.currentCheckedIndex?a("div",{staticClass:"image-check"},[a("i",{staticClass:"el-icon-check"})]):e._e(),e.isShowOperation?a("div",{staticClass:"image-operation"},[a("el-button",{attrs:{icon:t.is_collected?"iconfont icon-shoucang2":"iconfont icon-shoucang_quxiaoshoucang",circle:"",size:"mini",type:"warning",loading:t.isLoading},on:{click:function(a){return e.onStar(!t.is_collected,t.id,i)}}}),a("el-button",{attrs:{icon:"iconfont icon-shanchu",circle:"",type:"danger",size:"mini",loading:t.isLoading},on:{click:function(a){return e.onDelete(t.id,i)}}})],1):e._e()],1)])})),1),a("el-pagination",{staticClass:"pagination",attrs:{background:"","current-page":e.page,layout:"prev, pager, next",total:e.totalCount},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"current-change":function(t){return e.loadImageList(e.page)}}}),a("el-dialog",{attrs:{title:"上传素材",visible:e.dialogVisible,"append-to-body":!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?a("el-upload",{attrs:{drag:"",action:"http://api-toutiao-web.itheima.net/mp/v1_0/user/images",headers:e.uploadHeaders,name:"image","on-success":e.onUploadSuccess,"on-error":e.onUploadError,multiple:""}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传图片格式文件，且图片不能太大！！！")])]):e._e()],1)],1)},n=[],o=a("1da1"),s=(a("96cf"),a("159b"),a("685c")),r={name:"ImageList",props:{isShowAdd:{type:Boolean,default:!0},isShowOperation:{type:Boolean,default:!0},isShowChecked:{type:Boolean,default:!1}},data:function(){var e=window.localStorage.getItem("user");return{isCollect:!1,perPage:12,imageList:[],totalCount:0,page:1,dialogVisible:!1,uploadHeaders:{Authorization:"Bearer ".concat(e)},currentCheckedIndex:null}},created:function(){this.loadImageList(1)},methods:{loadImageList:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var i,n,o,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.currentCheckedIndex=null,a.prev=1,a.next=4,Object(s["b"])({page:e,collect:t.isCollect,per_page:t.perPage});case 4:i=a.sent,n=i.data.data,o=n.results,r=n.total_count,o.forEach((function(e){e.isLoading=!1})),t.imageList=o,t.totalCount=r,a.next=14;break;case 11:a.prev=11,a.t0=a["catch"](1),console.log(a.t0);case 14:case"end":return a.stop()}}),a,null,[[1,11]])})))()},onLabelChange:function(){this.loadImageList(1)},onUploadSuccess:function(){this.dialogVisible=!1,this.loadImageList(1),this.$msgSuccess("图片上传成功！")},onUploadError:function(){this.dialogVisible=!1,this.loadImageList(1),this.$msgError("图片尺寸过大！")},onStar:function(e,t,a){var i=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i.imageList[a].isLoading=!0,n.prev=1,n.next=4,Object(s["c"])({collect:e},t);case 4:i.loadImageList(i.page),i.imageList[a].isLoading=!1,i.$msgSuccess("图片".concat(e?"收藏":"取消收藏","成功！")),n.next=14;break;case 9:n.prev=9,n.t0=n["catch"](1),console.log(n.t0),i.imageList[a].isLoading=!1,i.$msgError("图片".concat(e?"收藏":"取消收藏","成功！"));case 14:case"end":return n.stop()}}),n,null,[[1,9]])})))()},onDelete:function(e,t){var a=this;return Object(o["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return a.imageList[t].isLoading=!0,i.prev=1,i.next=4,Object(s["a"])(e);case 4:a.loadImageList(a.page),a.imageList[t].isLoading=!1,a.$msgSuccess("图片删除成功！"),i.next=14;break;case 9:i.prev=9,i.t0=i["catch"](1),console.log(i.t0),a.imageList[t].isLoading=!1,a.$msgError("图片删除失败！");case 14:case"end":return i.stop()}}),i,null,[[1,9]])})))()},onImageCheck:function(e){this.currentCheckedIndex=e}}},c=r,l=(a("5764"),a("2877")),u=Object(l["a"])(c,i,n,!1,null,"60a747fc",null);t["a"]=u.exports},5764:function(e,t,a){"use strict";a("ba0c")},"685c":function(e,t,a){"use strict";a.d(t,"d",(function(){return n})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return r}));var i=a("b775"),n=function(e){return Object(i["a"])({method:"POST",url:"/mp/v1_0/user/images",data:e})},o=function(e){return Object(i["a"])({method:"GET",url:"/mp/v1_0/user/images",params:e})},s=function(e,t){return Object(i["a"])({method:"PUT",url:"/mp/v1_0/user/images/".concat(t),data:e})},r=function(e){return Object(i["a"])({method:"DELETE",url:"/mp/v1_0/user/images/".concat(e)})}},ba0c:function(e,t,a){},e036:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"image-container"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("素材管理")])],1)],1),a("image-list")],1)],1)},n=[],o=a("3c33"),s={name:"ImageIndex",components:{ImageList:o["a"]}},r=s,c=a("2877"),l=Object(c["a"])(r,i,n,!1,null,"7c10d214",null);t["default"]=l.exports}}]);
//# sourceMappingURL=chunk-37c856b6.3d2752af.js.map